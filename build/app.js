var vt="tetrix";var wt={type:"git",url:"https://github.com/Valexr/Tetrix"};function g(){}function st(t){return t()}function $t(){return Object.create(null)}function C(t){t.forEach(st)}function j(t){return typeof t=="function"}function k(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Et(t){return Object.keys(t).length===0}function lt(t,...e){if(t==null)return g;let n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function v(t){let e;return lt(t,n=>e=n)(),e}function N(t,e,n){t.$$.on_destroy.push(lt(e,n))}function St(t){return t&&j(t.destroy)?t.destroy:g}var Ct=!1;function Xt(){Ct=!0}function Jt(){Ct=!1}function m(t,e){t.appendChild(e)}function x(t,e,n){t.insertBefore(e,n||null)}function b(t){t.parentNode&&t.parentNode.removeChild(t)}function ct(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function h(t){return document.createElement(t)}function E(t){return document.createTextNode(t)}function S(){return E(" ")}function nt(){return E("")}function Y(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function _(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Z(t){return t===""?null:+t}function Vt(t){return Array.from(t.childNodes)}function U(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Q(t,e){t.value=e??""}function ut(t,e,n,i){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,i?"important":"")}function W(t,e,n){t.classList[n?"add":"remove"](e)}var at;function K(t){at=t}var G=[];var Ft=[],tt=[],kt=[],Kt=Promise.resolve(),it=!1;function Zt(){it||(it=!0,Kt.then(Dt))}function rt(t){tt.push(t)}var ot=new Set,I=0;function Dt(){if(I!==0)return;let t=at;do{try{for(;I<G.length;){let e=G[I];I++,K(e),Qt(e.$$)}}catch(e){throw G.length=0,I=0,e}for(K(null),G.length=0,I=0;Ft.length;)Ft.pop()();for(let e=0;e<tt.length;e+=1){let n=tt[e];ot.has(n)||(ot.add(n),n())}tt.length=0}while(G.length);for(;kt.length;)kt.pop()();it=!1,ot.clear(),K(t)}function Qt(t){if(t.fragment!==null){t.update(),C(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(rt)}}var et=new Set,L;function ft(){L={r:0,c:[],p:L}}function dt(){L.r||C(L.c),L=L.p}function $(t,e){t&&t.i&&(et.delete(t),t.i(e))}function D(t,e,n,i){if(t&&t.o){if(et.has(t))return;et.add(t),L.c.push(()=>{et.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}else i&&i()}var ve=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function X(t){t&&t.c()}function B(t,e,n,i){let{fragment:o,after_update:r}=t.$$;o&&o.m(e,n),i||rt(()=>{let s=t.$$.on_mount.map(st).filter(j);t.$$.on_destroy?t.$$.on_destroy.push(...s):C(s),t.$$.on_mount=[]}),r.forEach(rt)}function q(t,e){let n=t.$$;n.fragment!==null&&(C(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function te(t,e){t.$$.dirty[0]===-1&&(G.push(t),Zt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function M(t,e,n,i,o,r,s,a=[-1]){let c=at;K(t);let l=t.$$={fragment:null,ctx:[],props:r,update:g,not_equal:o,bound:$t(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:$t(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};s&&s(l.root);let u=!1;if(l.ctx=n?n(t,e.props||{},(f,d,...p)=>{let A=p.length?p[0]:d;return l.ctx&&o(l.ctx[f],l.ctx[f]=A)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](A),u&&te(t,f)),d}):[],l.update(),u=!0,C(l.before_update),l.fragment=i?i(l.ctx):!1,e.target){if(e.hydrate){Xt();let f=Vt(e.target);l.fragment&&l.fragment.l(f),f.forEach(b)}else l.fragment&&l.fragment.c();e.intro&&$(t.$$.fragment),B(t,e.target,e.anchor,e.customElement),Jt(),Dt()}K(c)}var ee;typeof HTMLElement=="function"&&(ee=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){let{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(st).filter(j);for(let e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){C(this.$$.on_disconnect)}$destroy(){q(this,1),this.$destroy=g}$on(t,e){if(!j(e))return g;let n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{let i=n.indexOf(e);i!==-1&&n.splice(i,1)}}$set(t){this.$$set&&!Et(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});var F=class{$destroy(){q(this,1),this.$destroy=g}$on(e,n){if(!j(n))return g;let i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{let o=i.indexOf(n);o!==-1&&i.splice(o,1)}}$set(e){this.$$set&&!Et(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var J=[];function Mt(t,e){return{subscribe:P(t,e).subscribe}}function P(t,e=g){let n,i=new Set;function o(a){if(k(t,a)&&(t=a,n)){let c=!J.length;for(let l of i)l[1](),J.push(l,t);if(c){for(let l=0;l<J.length;l+=2)J[l][0](J[l+1]);J.length=0}}}function r(a){o(a(t))}function s(a,c=g){let l=[a,c];return i.add(l),i.size===1&&(n=e(o)||g),a(t),()=>{i.delete(l),i.size===0&&(n(),n=null)}}return{set:o,update:r,subscribe:s}}function Ot(t,e,n){return Math.min(Math.max(e,t),n)}function At(t){return Math.floor(Math.random()*t)}function V(t,e){return t.x===e.x&&t.y===e.y}function ne(){let{subscribe:t,set:e,update:n}=P([]);function i(o,{y:r}){return o[r]=o[r]||0,o[r]+=1,o}return{subscribe:t,set:e,clear(){e([])},add(o){n(r=>r.concat(o))},include(o){return v(this).some(r=>o.some(s=>V(r,s)))},check(){let o=[];return n(r=>{let s=r.reduce(i,{}),a=r.filter(({x:l,y:u})=>s[u]!==10);return o=r.filter(({x:l,y:u})=>s[u]===10),a.map(({x:l,y:u})=>{let d=o.some(p=>p.y>u)?u+o.length/10:u;return{x:l,y:d}})}),o.length},reduce(){},full(){return v(this).some(({x:o,y:r})=>!r)}}}var O=ne();var Tt={B:[{x:4,y:-2},{x:5,y:-2},{x:4,y:-1},{x:5,y:-1}],I:[{x:4,y:-4},{x:4,y:-3},{x:4,y:-2},{x:4,y:-1}],T:[{x:3,y:-2},{x:4,y:-2},{x:5,y:-2},{x:4,y:-1}],L:[{x:4,y:-3},{x:4,y:-2},{x:4,y:-1},{x:5,y:-1}],J:[{x:5,y:-3},{x:5,y:-2},{x:5,y:-1},{x:4,y:-1}],Z:[{x:3,y:-2},{x:4,y:-2},{x:4,y:-1},{x:5,y:-1}],S:[{x:3,y:-1},{x:4,y:-1},{x:4,y:-2},{x:5,y:-2}]};function oe(){let{subscribe:t,set:e,update:n}=P([]),i={Up:{x:0,y:-1},Down:{x:0,y:1},Left:{x:-1,y:0},Right:{x:1,y:0}},o="";return{subscribe:t,set:e,name:o,random(){let r=Object.keys(Tt);o=r[At(r.length)],this.get(o)},get(r){e(Tt[r])},move(r){let s=!1,a=!1;return n(c=>{let u=typeof r=="object"?r:i[r],f=c.map(({x:d,y:p})=>({x:d+u.x,y:p+u.y}));return s=f.some(({x:d,y:p})=>d<0||d>=10||p>=20),a=O.include(f)||f.some(({x:d,y:p})=>p>=20),a||s?c:f}),a},rotate(){let r=v(this)[1],s=c=>r.y-c.y+r.x,a=c=>r.y-r.x+c.x;o!=="B"&&n(c=>{let l=c.map(d=>({x:s(d),y:a(d)})),u=l.some(({x:d,y:p})=>d<0||d>=10||p>=20),f=O.include(l);return u||f?c:l})},include(r){return v(this).some(s=>V(r,s))}}}var w=oe();var Nt=Mt({width:10,height:20});function ie(){let{subscribe:t,set:e,update:n}=P();e({state:"",score:0,speed:1});function i(r){n(s=>Object.assign(s,{state:r}))}function o(r){n(s=>Object.assign(s,{score:r}))}return{subscribe:t,state:i,score:o,set:e,start(){o(0),i("play"),O.clear(),w.random(),_t()},pause(){i("pause")},resume(){i("play"),_t()},stop(){i("stop")},scoreup(){n(r=>Object.assign(r,{score:r.score+pt*r.speed}))},speedup(){n(r=>Object.assign(r,{speed:Ot(1,r.speed+1,10)}))}}}var y=ie(),jt=!1,pt=0;function _t(){setTimeout(()=>{v(y).state==="play"&&(re(),_t())},900-80*v(y).speed)}function re(){O.full()&&y.stop(),jt=w.move("Down"),jt&&(O.add(v(w)),pt=O.check(),y.scoreup(),pt&&!(v(y).score%100)&&y.speedup(),w.random())}function se(t){let e,n=t[0].state==="pause"?"Resume":"Start",i,o,r,s,a,c=t[0].state!=="pause"&&qt(t);return{c(){e=h("button"),i=E(n),o=S(),c&&c.c(),r=nt(),_(e,"class","lg")},m(l,u){x(l,e,u),m(e,i),x(l,o,u),c&&c.m(l,u),x(l,r,u),s||(a=Y(e,"click",function(){j(t[0].state==="pause"?y.resume:y.start)&&(t[0].state==="pause"?y.resume:y.start).apply(this,arguments)}),s=!0)},p(l,u){t=l,u&1&&n!==(n=t[0].state==="pause"?"Resume":"Start")&&U(i,n),t[0].state!=="pause"?c?c.p(t,u):(c=qt(t),c.c(),c.m(r.parentNode,r)):c&&(c.d(1),c=null)},d(l){l&&b(e),l&&b(o),c&&c.d(l),l&&b(r),s=!1,a()}}}function le(t){let e,n,i,o,r;return{c(){e=h("button"),e.textContent="Pause",n=S(),i=h("button"),i.textContent="Stop"},m(s,a){x(s,e,a),x(s,n,a),x(s,i,a),o||(r=[Y(e,"click",y.pause),Y(i,"click",y.stop)],o=!0)},p:g,d(s){s&&b(e),s&&b(n),s&&b(i),o=!1,C(r)}}}function qt(t){let e,n,i,o,r,s,a,c,l,u;return{c(){e=h("fieldset"),n=h("label"),i=E(`Speed
                        `),o=h("input"),r=S(),s=h("label"),a=E(`Heap
                        `),c=h("input"),_(o,"type","number"),_(o,"min","1"),_(o,"max","10"),_(o,"maxlength","2"),_(o,"size","3"),_(c,"type","number"),_(c,"min","1"),_(c,"max","10"),_(c,"maxlength","2"),_(c,"size","3")},m(f,d){x(f,e,d),m(e,n),m(n,i),m(n,o),Q(o,t[0].speed),m(e,r),m(e,s),m(s,a),m(s,c),Q(c,t[0].speed),l||(u=[Y(o,"input",t[1]),Y(c,"input",t[2])],l=!0)},p(f,d){d&1&&Z(o.value)!==f[0].speed&&Q(o,f[0].speed),d&1&&Z(c.value)!==f[0].speed&&Q(c,f[0].speed)},d(f){f&&b(e),l=!1,C(u)}}}function ce(t){let e,n;function i(s,a){return s[0].state==="play"?le:se}let o=i(t,-1),r=o(t);return{c(){e=h("footer"),n=h("nav"),r.c(),W(n,"playing",t[0].state==="play")},m(s,a){x(s,e,a),m(e,n),r.m(n,null)},p(s,[a]){o===(o=i(s,a))&&r?r.p(s,a):(r.d(1),r=o(s),r&&(r.c(),r.m(n,null))),a&1&&W(n,"playing",s[0].state==="play")},i:g,o:g,d(s){s&&b(e),r.d()}}}function ue(t,e,n){let i;N(t,y,s=>n(0,i=s));function o(){i.speed=Z(this.value),y.set(i)}function r(){i.speed=Z(this.value),y.set(i)}return[i,o,r]}var mt=class extends F{constructor(e){super(),M(this,e,ue,ce,k,{})}},Rt=mt;function ae(t){let e,n,i;return{c(){e=h("span"),_(e,"class","pixel"),_(e,"data-x",n=t[0].x),_(e,"data-y",i=t[0].y),W(e,"fill",t[1])},m(o,r){x(o,e,r)},p(o,[r]){r&1&&n!==(n=o[0].x)&&_(e,"data-x",n),r&1&&i!==(i=o[0].y)&&_(e,"data-y",i),r&2&&W(e,"fill",o[1])},i:g,o:g,d(o){o&&b(e)}}}function fe(t,e,n){let i,{filled:o}=e,{pixel:r}=e;return t.$$set=s=>{"filled"in s&&n(2,o=s.filled),"pixel"in s&&n(0,r=s.pixel)},t.$$.update=()=>{if(t.$$.dirty&5)t:n(1,i=o.some(s=>V(r,s)))},[r,i,o]}var ht=class extends F{constructor(e){super(),M(this,e,fe,ae,k,{filled:2,pixel:0})}},Lt=ht;function Bt(t){window.onkeydown=l=>e(l),t.onclick=l=>n(l);function e(l){if(v(y).state==="play")if(l.key.includes("Arrow")){let u=l.key.replace("Arrow","");u==="Up"?w.rotate():w.move(u)}else l.key.includes("Escape")&&(l.preventDefault(),y.pause())}function n(l){if(v(y).state!=="play")return;let{dataset:{x:u,y:f}}=l.target;if(u&&f){let d={x:Number(u),y:Number(f)};if(w.include(d))w.rotate();else{let p=v(w),A=p.every(({x:R,y:H})=>R<d.x)?"Right":p.every(({x:R,y:H})=>H<d.y)?"Down":"Left";w.move(A)}}}let i=0,o=0,r=!1;function s(l){let{dataset:{x:u,y:f}}=l.target,d={x:Number(u),y:Number(f)};i=l.clientX,o=l.clientY,r=w.include(d)}function a(l){if(r){let{clientX:u,clientY:f}=l,d=(u-i)%50,p=f-o;console.log(d,p);let A={x:d,y:p};w.move({x:d,y:0})}}function c(l){r=!1}}function Pt(t,e,n){let i=t.slice();return i[3]=e[n],i[5]=n,i}function Ht(t,e,n){let i=t.slice();return i[3]=e[n],i[7]=n,i}function zt(t){let e,n;return e=new Lt({props:{pixel:{x:t[7],y:t[5]},filled:[...t[1],...t[2]]}}),{c(){X(e.$$.fragment)},m(i,o){B(e,i,o),n=!0},p(i,o){let r={};o&6&&(r.filled=[...i[1],...i[2]]),e.$set(r)},i(i){n||($(e.$$.fragment,i),n=!0)},o(i){D(e.$$.fragment,i),n=!1},d(i){q(e,i)}}}function It(t){let e,n,i={length:t[0].width},o=[];for(let s=0;s<i.length;s+=1)o[s]=zt(Ht(t,i,s));let r=s=>D(o[s],1,1,()=>{o[s]=null});return{c(){for(let s=0;s<o.length;s+=1)o[s].c();e=nt()},m(s,a){for(let c=0;c<o.length;c+=1)o[c].m(s,a);x(s,e,a),n=!0},p(s,a){if(a&7){i={length:s[0].width};let c;for(c=0;c<i.length;c+=1){let l=Ht(s,i,c);o[c]?(o[c].p(l,a),$(o[c],1)):(o[c]=zt(l),o[c].c(),$(o[c],1),o[c].m(e.parentNode,e))}for(ft(),c=i.length;c<o.length;c+=1)r(c);dt()}},i(s){if(!n){for(let a=0;a<i.length;a+=1)$(o[a]);n=!0}},o(s){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)D(o[a]);n=!1},d(s){ct(o,s),s&&b(e)}}}function de(t){let e,n,i,o,r,s,a={length:t[0].height},c=[];for(let u=0;u<a.length;u+=1)c[u]=It(Pt(t,a,u));let l=u=>D(c[u],1,1,()=>{c[u]=null});return{c(){e=h("main"),n=h("section");for(let u=0;u<c.length;u+=1)c[u].c();_(n,"id","board"),ut(n,"--cols",t[0].width)},m(u,f){x(u,e,f),m(e,n);for(let d=0;d<c.length;d+=1)c[d].m(n,null);o=!0,r||(s=St(i=Bt.call(null,n)),r=!0)},p(u,[f]){if(f&7){a={length:u[0].height};let d;for(d=0;d<a.length;d+=1){let p=Pt(u,a,d);c[d]?(c[d].p(p,f),$(c[d],1)):(c[d]=It(p),c[d].c(),$(c[d],1),c[d].m(n,null))}for(ft(),d=a.length;d<c.length;d+=1)l(d);dt()}(!o||f&1)&&ut(n,"--cols",u[0].width)},i(u){if(!o){for(let f=0;f<a.length;f+=1)$(c[f]);o=!0}},o(u){c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)D(c[f]);o=!1},d(u){u&&b(e),ct(c,u),r=!1,s()}}}function pe(t,e,n){let i,o,r;return N(t,Nt,s=>n(0,i=s)),N(t,w,s=>n(1,o=s)),N(t,O,s=>n(2,r=s)),[i,o,r]}var yt=class extends F{constructor(e){super(),M(this,e,pe,de,k,{})}},Gt=yt;var Yt='<svg width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" fill="currentColor"/></svg>';function me(t){let e,n,i,o=t[2].score+"",r,s,a,c,l,u,f,d,p,A,R=t[2].speed+"",H;return{c(){e=h("header"),n=h("p"),i=E("Score: "),r=E(o),s=S(),a=h("h1"),c=h("a"),u=S(),f=E(t[0]),d=S(),p=h("p"),A=E("Speed: "),H=E(R),_(c,"href",l=t[1].url),_(c,"target","_blank"),_(c,"rel","noreferrer"),_(c,"id","gh")},m(T,z){x(T,e,z),m(e,n),m(n,i),m(n,r),m(e,s),m(e,a),m(a,c),c.innerHTML=Yt,m(a,u),m(a,f),m(e,d),m(e,p),m(p,A),m(p,H)},p(T,[z]){z&4&&o!==(o=T[2].score+"")&&U(r,o),z&2&&l!==(l=T[1].url)&&_(c,"href",l),z&1&&U(f,T[0]),z&4&&R!==(R=T[2].speed+"")&&U(H,R)},i:g,o:g,d(T){T&&b(e)}}}function he(t,e,n){let i;N(t,y,s=>n(2,i=s));let{name:o}=e,{repository:r}=e;return t.$$set=s=>{"name"in s&&n(0,o=s.name),"repository"in s&&n(1,r=s.repository)},[o,r,i]}var gt=class extends F{constructor(e){super(),M(this,e,he,me,k,{name:0,repository:1})}},Ut=gt;function ye(t){let e,n,i,o,r,s,a,c;return document.title=e=t[0],i=new Ut({props:{name:t[0],repository:t[1]}}),r=new Gt({}),a=new Rt({}),{c(){n=S(),X(i.$$.fragment),o=S(),X(r.$$.fragment),s=S(),X(a.$$.fragment)},m(l,u){x(l,n,u),B(i,l,u),x(l,o,u),B(r,l,u),x(l,s,u),B(a,l,u),c=!0},p(l,[u]){(!c||u&1)&&e!==(e=l[0])&&(document.title=e);let f={};u&1&&(f.name=l[0]),u&2&&(f.repository=l[1]),i.$set(f)},i(l){c||($(i.$$.fragment,l),$(r.$$.fragment,l),$(a.$$.fragment,l),c=!0)},o(l){D(i.$$.fragment,l),D(r.$$.fragment,l),D(a.$$.fragment,l),c=!1},d(l){l&&b(n),q(i,l),l&&b(o),q(r,l),l&&b(s),q(a,l)}}}function ge(t,e,n){let{name:i}=e,{repository:o}=e;return t.$$set=r=>{"name"in r&&n(0,i=r.name),"repository"in r&&n(1,o=r.repository)},[i,o]}var bt=class extends F{constructor(e){super(),M(this,e,ge,ye,k,{name:0,repository:1})}},Wt=bt;var be=new Wt({target:document.body,props:{name:vt,repository:wt}}),En=be;export{En as default};
